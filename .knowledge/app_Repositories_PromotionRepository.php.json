{"is_source_file": true, "format": "PHP", "description": "This file defines the PromotionRepository class which implements promotion validation logic, including checking promo code validity, eligibility, and redemption limits within a ticketing or event management system. It interacts with models such as Promotion, TicketPackage, and TicketSale, and uses Laravel framework features like validation, logging, and database querying.", "external_files": ["app/Models/Promotion", "app/Models/TicketPackage", "app/Models/TicketSale", "app/Models/User", "app/Services/PromotionService", "Illuminate/Http/Request", "Illuminate/Support/Facades/DB", "Illuminate/Support/Facades/Log", "Illuminate/Support/Facades/Validator"], "external_methods": ["Validator::make", "Promotion::with", "Promotion::where", "Promotion::first", "TicketSale::with", "TicketSale::whereHas", "TicketSale::where", "TicketPackage::findOrFail", "Log::info", "Log::error"], "published": ["checkPromoCodeValidity"], "classes": [{"name": "PromotionRepository", "description": "Repository class responsible for handling promotion validation, including promo code validation, eligibility checks, and redemption limit enforcement."}], "methods": [{"name": "checkPromoCodeValidity", "description": "Validates the provided promo code and ticket details, checks redemption limits, and determines eligibility based on ticket counts and promotion rules."}, {"name": "checkEligibility", "description": "Checks if the ticket purchase meets the promotion's minimum and maximum ticket requirements and calculates discounts accordingly."}], "calls": ["Validator::make", "Promotion::with", "Promotion::where", "Promotion::first", "TicketSale::with", "TicketSale::whereHas", "TicketSale::where", "TicketPackage::findOrFail", "Log::info", "Log::error"], "search-terms": ["PromotionRepository", "checkPromoCodeValidity", "promo_code validation", "ticket package eligibility", "redemption limit", "Laravel promotion validation"], "state": 2, "filename": "app/Repositories/PromotionRepository.php", "format-version": 4, "code-base-name": "https://github.com/kanishkabodaragama/spotseekertest.git:main", "knowledge_revision": 221, "git_revision": "113c79228ad261d8e3a3fd4395fe790f78c2319c", "revision_history": [{"221": "113c79228ad261d8e3a3fd4395fe790f78c2319c"}]}