{"is_source_file": true, "format": "PHP", "description": "This PHP class defines a console command 'PendingBookingRemovalCron' that removes pending bookings and updates related ticket packages and sub-bookings in a Laravel application. It handles database transactions, logging, and exception management.", "external_files": ["App/Enums/BookingStatus.php", "App/Enums/PaymentStatus.php", "App/Models/TicketPackage.php", "App/Models/TicketSale.php", "Illuminate/Console/Command.php", "Illuminate/Database/QueryException.php", "Illuminate/Database/Eloquent/ModelNotFoundException.php", "Illuminate/Support/Facades/DB.php", "Illuminate/Support/Facades/Log.php", "Carbon/Carbon.php"], "external_methods": ["DB::beginTransaction", "DB::commit", "DB::rollBack", "TicketSale::with", "Log::info", "Log::channel", "TicketPackage::findOrFail", "Log::error", "Carbon::now", "Model->save", "SubBooking->save"], "published": ["PendingBookingRemovalCron"], "classes": [{"name": "PendingBookingRemovalCron", "description": "A Laravel console command class that handles the removal of pending bookings and updates related ticket packages and sub-bookings."}], "methods": [{"name": "handle", "description": "Executes the logic to find pending bookings, update ticket packages, cancel bookings and sub-bookings, with transaction management and error handling."}], "calls": ["DB::beginTransaction", "TicketSale::with", "Log::info", "Log::channel", "TicketPackage::findOrFail", "Log::error", "DB::commit", "DB::rollBack", "Carbon::now", "Model->save", "SubBooking->save"], "search-terms": ["PendingBookingRemovalCron", "pbr:cron", "remove pending booking tickets", "ticket package update", "cancelled bookings", "Laravel console command", "ticket sale packages", "sub bookings cancellation"], "state": 2, "filename": "app/Console/Commands/PendingBookingRemovalCron.php", "format-version": 4, "code-base-name": "https://github.com/kanishkabodaragama/spotseekertest.git:main", "knowledge_revision": 136, "git_revision": "113c79228ad261d8e3a3fd4395fe790f78c2319c", "revision_history": [{"136": "113c79228ad261d8e3a3fd4395fe790f78c2319c"}]}